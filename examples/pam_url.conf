# pam_url configuration file

pam_url:
{
    settings:
    {
        url         = "https://totp.example.com/"; # URI to fetch
        returncode  = "OK";                        # The remote script/cgi should return a 200 http code and this string as its only results
        userfield   = "user";                      # userfield name to send
        passwdfield = "token";                     # passwdfield name to send
        extradata   = "&do=login";                 # extra data to send
        prompt      = "Token: ";                   # password prompt
        connect_timeout_ms = 2000;                 # Connect timeout of 2000ms
        timeout_ms  = 10000;                       # Overall timeout of 10000ms
                                                   # Take into consideration that the remote end might delay a response on
                                                   # purpose when the password is incorrect, to limit brute force attempts
    };

    ssl:
    {
        verify_peer = true;                               # Verify peer?
        verify_host = true;                               # Make sure peer CN matches?
        client_cert = "/etc/pki/tls/certs/totpcgi.crt";   # Client-side certificate
        client_key  = "/etc/pki/tls/private/totpcgi.pem"; # Client-side key
        ca_cert     = "/etc/pki/tls/certs/ca-bundle.crt"; # ca cert - defaults to ca-bundle.crt
    };
};

# END
